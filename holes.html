<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Signature golf holes across South Carolina with ratings for fun, difficulty, and maintenance.">
  <meta name="keywords" content="golf, signature holes, South Carolina golf, course ratings">
  <meta name="author" content="Michael Gilroy">

  <title>Course Caddy – Signature Holes</title>

  <!-- External stylesheet -->
  <link rel="stylesheet" href="css/styles.css" />

  <!-- PapaParse -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <!-- Page-local (embedded) styling -->
  <style>
    :root{
      --brand:#003C21;
      --ink:#111;
      --bg:#f8faf9;
      --card:#fff;
      --ring:#d1d5db;
    }

    body{ margin:0; font-family:Segoe UI,Arial,sans-serif; background:var(--bg); color:var(--ink); }
    main{ max-width:1000px; margin:1rem auto; padding:1rem; }
    .card{ background:var(--card); border:1px solid var(--ring); border-radius:12px; }
    .pad{ padding:1rem; }
    .controls{ margin:1rem 0; display:flex; flex-wrap:wrap; gap:.5rem; align-items:center; }
    input,select,button{ padding:.5rem; border:1px solid var(--ring); border-radius:8px; background:#fff; }

    header{ background:var(--brand); }
    .nav{ max-width:1200px; margin:0 auto; padding:.75rem 1rem; display:flex; justify-content:space-between; align-items:center; }
    .nav-left{ display:flex; align-items:center; gap:.5rem; }
    .logo-img{ height:48px; width:auto; }
    .logo-text{ font-weight:800; font-size:1.25rem; color:#fff; letter-spacing:1px; }
    .tabs{ display:flex; gap:1rem; }
    .tab{ padding:.5rem 1rem; border-radius:999px; color:#fff; text-decoration:none; font-weight:600; }
    .tab.active{ background:#fff; color:var(--brand); }

    #holesTable{ width:100%; border-collapse:separate; border-spacing:0; }
    #holesTable th, #holesTable td{ padding:1rem; text-align:left; vertical-align:middle; }
    #holesTable thead th{ border-bottom:1px solid var(--ring); }
    #holesTable tbody tr:hover{ background:#f3f9f5; }

    .course-cell{ display:flex; flex-direction:column; align-items:center; text-align:center; gap:.5rem; }
    .course-name{ font-size:1.1rem; font-weight:700; color:var(--brand); }
    .signature-photo{
      width:320px; height:220px; object-fit:cover;
      border-radius:10px; border:1px solid var(--ring);
      cursor:pointer; background:#eee;
    }

    .details{ text-align:center; display:flex; flex-direction:column; gap:.5rem; }
    .label{ font-weight:700; }

    .stars{ display:flex; flex-direction:column; align-items:center; gap:.25rem; }
    .star-row{ display:flex; gap:2px; }
    .star{ font-size:22px; }
    .star.full{ color:#f4c430; }
    .star.empty{ color:#d9d9d9; }
    .star.half{
      background:linear-gradient(90deg,#f4c430 50%,#d9d9d9 50%);
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }

    .checkset{ display:inline-flex; gap:.75rem; align-items:center; padding:.25rem .5rem; border:1px solid var(--ring); border-radius:8px; background:#fff; }
    .note{ color:#666; font-size:.9rem; margin-top:.5rem; }
  </style>
</head>

<body>
  <!-- ============================
       HEADER + NAVIGATION
       ============================ -->
  <header>
    <nav class="nav">
      <div class="nav-left">
        <img src="assets/photos/CClogo.png" alt="Caddy Compass Logo" class="logo-img" />
        <span class="logo-text">CADDY COMPASS</span>
      </div>
      <div class="tabs">
        <a href="index.html" class="tab">Home</a>
        <a href="holes.html" class="tab active">Signature Holes</a>
        <a href="courses.html" class="tab">Courses</a>
        <a href="review.html" class="tab">Review</a>
      </div>
    </nav>
  </header>

  <!-- ============================
       MAIN CONTENT
       ============================ -->
  <main id="signature-holes-page">
    <h1 class="page-title">Signature Holes of South Carolina</h1>

    <section class="card pad">
      <!-- Filter controls -->
      <div class="controls">
        <input id="q" type="text" placeholder="Search course/city">

        <span>Par</span>
        <div id="parGroup" class="checkset">
          <label><input type="checkbox" value="3" checked>3</label>
          <label><input type="checkbox" value="4" checked>4</label>
          <label><input type="checkbox" value="5" checked>5</label>
        </div>

        <span>Fun</span>
        <select id="minFun"></select> –
        <select id="maxFun"></select>

        <span>Difficulty</span>
        <select id="minDiff"></select> –
        <select id="maxDiff"></select>

        <button id="reset" type="button">Reset</button>
      </div>

      <!-- Results table -->
      <table id="holesTable" aria-live="polite">
        <thead>
          <tr>
            <th>Course / Hole</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div id="emptyState" class="note" style="display:none;">No matching rows.</div>
      <div id="loadError" class="note" style="display:none;">Could not load CSV file.</div>
    </section>
  </main>

  <!-- Lightbox modal -->
<div id="imgModal" class="modal" role="dialog" aria-hidden="true" aria-label="Hole photo viewer" style="display:none;">
  <span id="closeModal" class="modal-close">&times;</span>
  <img id="modalImg" src="" alt="Enlarged hole photo" />
</div>


  <!-- JavaScript -->
  <script>
    const $ = s => document.querySelector(s);

    async function loadCSV(path){
      const res = await fetch(path);
      if(!res.ok) throw new Error(res.status);
      const txt = await res.text();
      return Papa.parse(txt, {header:true, skipEmptyLines:true}).data;
    }

    const cleanPhotoPath = p => (p||'').trim().replace(/^assets\//i,'').replace(/^photos\//i,'');

    function hasPhoto(r){
      const p = cleanPhotoPath(r.photo).toLowerCase();
      if(!p || p === 'nophoto.png') return false;
      return !['na','none','null','0','-'].includes(p);
    }

    function starsHTML(val){
      const num = parseFloat(val);
      const v = isFinite(num) ? Math.max(0, Math.min(5, num)) : 0;

      const full = Math.floor(v);
      const frac = v - full;

      let half = 0, plus = 0;
      if(frac >= .75) plus = 1;
      else if(frac >= .25) half = 1;

      const totalFull = Math.min(5, full + plus);
      const empty = Math.max(0, 5 - totalFull - half);

      return `
        <div class="stars">
          <div class="star-row">
            ${'<span class="star full">★</span>'.repeat(totalFull)}
            ${half ? '<span class="star half">★</span>' : ''}
            ${'<span class="star empty">★</span>'.repeat(empty)}
          </div>
          <div class="rating-number">${isFinite(num) ? num.toFixed(1) : '-'}</div>
        </div>
      `;
    }

    function detailsHTML(r){
      const loc = [r.city, r.state].filter(Boolean).join(', ') + (r.postalCode ? ' ' + r.postalCode : '');
      return `
        <div class="details">
          <div><span class="label">Par:</span> ${r.par||'-'}</div>
          <div><span class="label">Yardage:</span> ${r.yardage||'-'}</div>
          <div><span class="label">Fun:</span> ${starsHTML(r.fun)}</div>
          <div><span class="label">Difficulty:</span> ${starsHTML(r.difficulty)}</div>
          <div><span class="label">Maintenance:</span> ${starsHTML(r.maintenance)}</div>
          <div><span class="label">Location:</span> ${loc||'-'}</div>
        </div>
      `;
    }

    function fillHalfStepSelect(id, def){
      const el = $(id);
      el.innerHTML = '';
      for(let v=0; v<=5.0001; v+=0.5){
        const o = document.createElement('option');
        o.value = v.toFixed(1);
        o.textContent = v.toFixed(1);
        if(v === def) o.selected = true;
        el.appendChild(o);
      }
    }

    function getSelectedPars(){
      return new Set(
        [...document.querySelectorAll('#parGroup input[type="checkbox"]')]
          .filter(b=>b.checked)
          .map(b=>b.value)
      );
    }

    function passesFilters(r){
      const q = ($('#q').value||'').toLowerCase();
      const matchQ = !q || (r.Course||'').toLowerCase().includes(q) || (r.city||'').toLowerCase().includes(q);

      const par = parseFloat(r.par);
      const selected = getSelectedPars();
      const parOK = isFinite(par) ? selected.has(String(par)) : true;

      const fun = parseFloat(r.fun);
      const diff = parseFloat(r.difficulty);

      const funOK = isFinite(fun) ? (fun >= parseFloat($('#minFun').value) && fun <= parseFloat($('#maxFun').value)) : true;
      const diffOK = isFinite(diff) ? (diff >= parseFloat($('#minDiff').value) && diff <= parseFloat($('#maxDiff').value)) : true;

      return matchQ && parOK && funOK && diffOK;
    }

    function render(rows){
      const tbody = document.querySelector('#holesTable tbody');
      tbody.innerHTML = '';

      const filtered = rows.filter(r => hasPhoto(r) && passesFilters(r));
      $('#emptyState').style.display = filtered.length ? 'none' : 'block';

      filtered.forEach(r=>{
        const img = 'assets/photos/' + cleanPhotoPath(r.photo);
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="course-cell">
            <div class="course-name">${r.Course||''} – Hole #${r.Hole||''}</div>
            <img src="${img}" alt="${r.Course||''} Hole ${r.Hole||''}" class="signature-photo" data-large="${img}">
          </td>
          <td>${detailsHTML(r)}</td>
        `;
        tbody.appendChild(tr);
      });

      document.querySelectorAll('.signature-photo').forEach(img=>{
        img.onclick = () => {
          $('#modalImg').src = img.dataset.large;
          $('#imgModal').style.display = 'flex';
          $('#imgModal').setAttribute('aria-hidden','false');
        };
      });
    }

    (async()=>{
      fillHalfStepSelect('#minFun',0.0);
      fillHalfStepSelect('#maxFun',5.0);
      fillHalfStepSelect('#minDiff',0.0);
      fillHalfStepSelect('#maxDiff',5.0);

      try{
        const rows = await loadCSV('assets/courses_holes.csv');
        render(rows);

        ['q','minFun','maxFun','minDiff','maxDiff'].forEach(id=>{
          $('#'+id).addEventListener('input',()=>render(rows));
        });

        document.querySelectorAll('#parGroup input').forEach(cb=>{
          cb.addEventListener('change',()=>render(rows));
        });

        $('#reset').addEventListener('click',()=>{
          $('#q').value='';
          document.querySelectorAll('#parGroup input').forEach(cb=>cb.checked=true);
          $('#minFun').value='0.0';
          $('#maxFun').value='5.0';
          $('#minDiff').value='0.0';
          $('#maxDiff').value='5.0';
          render(rows);
        });

      }catch(err){
        $('#loadError').style.display='block';
      }
    })();

    $('#closeModal').onclick = () => {
      $('#imgModal').style.display='none';
      $('#imgModal').setAttribute('aria-hidden','true');
    };
    $('#imgModal').onclick = e => {
      if(e.target.id==='imgModal'){
        $('#imgModal').style.display='none';
        $('#imgModal').setAttribute('aria-hidden','true');
      }
    };
  </script>

 
  <!-- ============================
       FOOTER
       ============================ -->
  <footer class="site-footer">
    <div class="footer-top">
      <div class="ft-col">
        <h4>Information</h4>
        <p><a href="#">Privacy policy</a> / <a href="#">Terms of use</a></p>
      </div>

      <div class="ft-col center">
        <h4><button class="back-to-top" type="button">Back to top</button></h4>
      </div>

      <div class="ft-col right">
        <h4>Stay connected</h4>
        <form id="newsletter" class="newsletter" novalidate>
          <input type="email" placeholder="*Email" aria-label="Email" required>
          <button type="submit">Join</button>
        </form>
      </div>
    </div>

    <div class="footer-divider"></div>

    <div class="footer-bottom">
      <div class="designer">Designed by Michael Gilroy</div>
      <div class="copyright">© 2025 Caddy Compass</div>
      <div class="contact">
        <div class="contact-title">Contact Info</div>
        <div>Ph: 555-555-5555</div>
        <div>Email: Gilroymj@email.sc.edu</div>
        <div>Myrtle Beach, SC</div>
      </div>
      <img class="footer-logo" src="assets/photos/CClogo.png" alt="Caddy Compass Logo">
    </div>
  </footer>

  <script>
    document.addEventListener('click', e=>{
      if(e.target.closest('.back-to-top')){
        window.scrollTo({top:0, behavior:'smooth'});
      }
    });
  </script>

</body>
</html>
